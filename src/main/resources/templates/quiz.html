<!-- templates/fragments/quiz-content.html -->
<div th:fragment="quizContent" class="quiz-container">

    <!-- ✅ course-detail: 웹/유니티 분기 -->
    <a class="quiz-back"
       th:href="${isUnity} ? @{/course-detail-unity(id=${courseId})} : @{/course-detail(id=${courseId})}">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        강좌로 돌아가기
    </a>

    <!-- 로딩 상태 -->
    <div id="loadingView" class="quiz-loading">
        <div class="spinner"></div>
        <p>퀴즈를 불러오는 중...</p>
    </div>

    <!-- 에러 상태 -->
    <div id="errorView" class="quiz-error" style="display: none;">
        <h2 id="errorTitle">퀴즈를 불러올 수 없습니다</h2>
        <p id="errorMessage"></p>

        <!-- ✅ course-detail: 웹/유니티 분기 -->
        <a th:href="${isUnity} ? @{/course-detail-unity(id=${courseId})} : @{/course-detail(id=${courseId})}">
            강좌로 돌아가기
        </a>
    </div>

    <!-- 퀴즈 응시 화면 -->
    <div id="quizView" style="display: none;">
        <div class="quiz-header">
            <h1 class="quiz-title" id="quizTitle"></h1>
            <p class="quiz-desc" id="quizDesc"></p>

            <div class="quiz-info-bar">
                <div class="quiz-info-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
                    </svg>
                    <span id="quizQuestionCount">0문제</span>
                </div>

                <div class="quiz-info-item">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                    </svg>
                    <span id="quizPassingScore">합격 기준: 80점</span>
                </div>

                <div class="quiz-info-item" id="timeLimitInfo" style="display: none;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/>
                    </svg>
                    <span id="quizTimeLimit">제한시간: 없음</span>
                </div>
            </div>
        </div>

        <!-- 타이머 (제한시간이 있을 때만 표시) -->
        <div class="quiz-timer" id="timerBar" style="display: none;">
            <span class="timer-text" id="timerText">00:00</span>
            <span class="quiz-progress-text" id="answeredCount">0 / 0 답변</span>
        </div>

        <!-- 문제 목록 -->
        <div id="questionsContainer"></div>

        <!-- 제출 -->
        <div class="quiz-submit-area">
            <button class="quiz-submit-btn" id="submitBtn" onclick="submitQuiz()">제출하기</button>
            <p class="quiz-unanswered-notice" id="unansweredNotice" style="display: none;"></p>
        </div>
    </div>

    <!-- 결과 화면 -->
    <div id="resultView" style="display: none;"></div>

    <!-- 오답 확인 화면 -->
    <div id="reviewView" style="display: none;"></div>

    <!-- ✅ JS가 읽을 수 있도록 isUnity도 내려줌 -->
    <input type="hidden" id="isUnity" th:value="${isUnity}">
</div>